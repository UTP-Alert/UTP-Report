<h2 class="text-2xl mb-4 flex items-center gap-3">
	<i class="check-circle-icon h-8 w-8 text-green-600"></i>
	Reportes Resueltos ({{ reportes.length }})
</h2>

<div class="resueltos-list">

  <div *ngIf="loading" class="card border-2 border-dashed border-gray-300">
	<div class="card-content p-12 text-center">
		<i class="check-circle-icon h-16 w-16 text-gray-400 mx-auto mb-4"></i>
		<h3 class="text-xl mb-2 text-gray-600">Cargando reportes resueltos...</h3>
	</div>
</div>

<!-- Image preview modal (Resueltos) - overlay fixed; click backdrop to close -->
<div *ngIf="imageModalVisible" class="modal-overlay" (click)="closeImage()" style="position:fixed; left:0; top:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.45); z-index:9999;">
	<div class="modal-card" style="position:relative; z-index:10000; max-width:920px; width:auto; display:inline-block; padding:0;">
		<img [src]="selectedImageSrc" alt="Evidencia" (click)="$event.stopPropagation()" style="max-width:100%; max-height:80vh; border-radius:8px; display:block; margin:0;" />
	</div>
</div>

  <div *ngIf="!loading && reportes.length === 0" class="card border-2 border-dashed border-gray-300">
	<div class="card-content p-12 text-center">
		<i class="check-circle-icon h-16 w-16 text-gray-400 mx-auto mb-4"></i>
		<h3 class="text-xl mb-2 text-gray-600">No hay reportes resueltos</h3>
		<p class="text-gray-500 mb-6">Todos los reportes resueltos se mostrarÃ¡n aquÃ­.</p>
		<span class="badge badge-outline px-4 py-2">ðŸ“‹ Estado: Esperando resoluciones</span>
	</div>
</div>

		<div *ngFor="let r of reportes" class="card resolved-card hover:shadow-lg transition-all mb-4">
			<div class="card-content row-flex">
				<div class="avatar-col">
					<div class="avatar-circle" [style.background]="(r.ultimaPrioridad||'')==='alta' ? '#ef4444' : ((r.ultimaPrioridad||'')==='media' ? '#f59e0b' : '#3b82f6')"></div>
				</div>


			<div class="main-col">
				<div class="title-row">
					<h3 class="title">{{ tiposMap[r.tipoIncidenteId] || 'Reporte' }}</h3>
					<div class="meta small">
						<span class="meta-item">{{ zonasMap[r.zonaId] || (r.zonaId ? ('Zona ' + r.zonaId) : 'Sin zona') }}</span>
						<span class="dot">â€¢</span>
						<span class="meta-item">Resuelto: {{ (r.reporteGestion && r.reporteGestion.fechaActualizacion) ? (r.reporteGestion.fechaActualizacion | date:'short') : (r.fechaUltimaGestion ? (r.fechaUltimaGestion | date:'short') : (r.fechaCreacion | date:'short')) }}</span>
						<span class="dot">â€¢</span>
						<span class="meta-item">ID: {{ r.id }}</span>
					</div>
				</div>

						<p class="desc">{{ r.descripcion }}</p>

						<!-- Ver foto debajo de la descripciÃ³n -->
								<div *ngIf="getImageSrc(r) as img" style="display:flex;align-items:center;gap:8px;margin-top:8px">
									<button class="button-outline button-sm" (click)="openImage(img)">ðŸ“· Ver foto</button>
									<img [src]="img" class="inline-thumb" alt="Evidencia" (click)="openImage(img)" />
								</div>

						<div class="icons-row">
					<span class="icon-item">ðŸ“· Evidencia: {{ r.foto ? 'sÃ­' : 'no' }}</span>
					<span class="icon-item">ðŸ”” {{ r.contacto ? 'Con contacto' : 'Sin contacto' }}</span>
					<span class="icon-item">âœ… Caso cerrado exitosamente</span>
				</div>
			</div>

			<div class="actions-col">
				<div class="badges-top">
					<span class="badge priority" [ngClass]="{'high': (r.ultimaPrioridad||'')==='alta','medium': (r.ultimaPrioridad||'')==='media','low': (r.ultimaPrioridad||'')==='baja'}">{{ (r.ultimaPrioridad||'') | uppercase }}</span>
					<span class="badge resuelto">RESUELTO</span>
				</div>

				<div class="actions">
					<button class="button button-sm button-outline"><i class="eye-icon h-4 w-4 mr-1"></i>Ver Detalle</button>
				</div>
			</div>

		</div>
	</div>

</div>
