<div class="super-admin-dashboard">
  <header class="dashboard-header">
    <!-- LOGO (Lado Izquierdo) -->
    <div class="logo">
      <i class="fas fa-shield-alt shield-icon"></i> <!-- Shield Icon -->
      <span>UTP+Report</span> <!-- Texto "UTP+Report" -->
    </div>

    <!-- NAVEGACIÓN DESKTOP (Centro) -->
    <nav class="main-nav">
      <ul>
        <li><a href="#" class="active"><i class="fas fa-home"></i> INICIO</a></li>
        <li><a href="#" class="btn btn-ghost text-secondary-foreground hover:bg-white/10 hover:text-white px-2 xl:px-4 py-2 text-xs xl:text-sm"><i class="fas fa-users"></i> GESTIÓN DE USUARIOS</a></li>
        <li><a href="#" class="btn btn-ghost text-secondary-foreground hover:bg-white/10 hover:text-white px-2 xl:px-4 py-2 text-xs xl:text-sm"><i class="fas fa-file-alt"></i> REPORTES SENSIBLES</a></li>
        <li><a href="#" class="btn btn-ghost text-secondary-foreground hover:bg-white/10 hover:text-white px-2 xl:px-4 py-2 text-xs xl:text-sm"><i class="fas fa-map-marker-alt"></i> ESTADO DE ZONAS</a></li>
      </ul>
    </nav>

    <!-- SECCIÓN USUARIO (Lado Derecho) -->
    <div class="user-profile">
      <!-- Notification Bell (Solo visible para admin, user, security) -->
      <i *ngIf="userRole === 'admin' || userRole === 'usuario' || userRole === 'seguridad'" class="fas fa-bell notification-bell"></i>

      <!-- SuperUser Badge -->
      <span *ngIf="userRole === 'Super Admin'" class="superuser-badge">
        <i class="fas fa-crown crown-icon"></i>
        {{ userName }} ({{ userRole }})
      </span>

      <!-- Usuario Normal Badge -->
      <span *ngIf="userRole !== 'Super Admin'" class="user-badge">
        <i class="fas fa-user-circle user-icon"></i>
        {{ userName }} ({{ userRole }})
      </span>

      <!-- Botón Logout -->
      <button class="logout-btn" (click)="toggleSession()">
        <i class="fas fa-sign-out-alt"></i>
      </button>

      <!-- Hamburger Button (Mobile Navigation) -->
      <button class="hamburger-btn" (click)="toggleMobileMenu()">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </header>

  <!-- Mobile Menu (conditionally rendered) -->
  <nav *ngIf="isMobileMenuOpen" class="mobile-nav-menu">
    <a href="#" class="active"><i class="fas fa-home"></i> INICIO</a>
    <a href="#"><i class="fas fa-users"></i> GESTIÓN DE USUARIOS</a>
    <a href="#"><i class="fas fa-file-alt"></i> REPORTES SENSIBLES</a>
    <a href="#"><i class="fas fa-map-marker-alt"></i> ESTADO DE ZONAS</a>
  </nav>

  <main class="dashboard-content">
    <div class="panel-header">
      <i class="fas fa-crown"></i>
      <h1>Panel de Superusuario</h1>
      <p>Control total del sistema de seguridad universitaria</p>
    </div>

    <section class="summary-section">
      <h2><i class="fas fa-cog"></i> Resumen del Sistema</h2>
      <div class="summary-cards">
        <div class="card">
          <i class="fas fa-building"></i>
          <span>1</span>
          <p>Sedes Activas</p>
        </div>
        <div class="card">
          <i class="fas fa-desktop"></i>
          <span>4</span>
          <p>Páginas Activas</p>
        </div>
        <div class="card">
          <i class="fas fa-exclamation-triangle"></i>
          <span>7</span>
          <p>Tipos de Incidentes</p>
        </div>
        <div class="card status-card">
          <i class="fas fa-check-circle"></i>
          <span>Activo</span>
          <p>Estado del Sistema</p>
        </div>
      </div>
    </section>

    <section class="navigation-tabs">
      <ul>
        <li><a href="#" class="active"><i class="fas fa-users-cog"></i> Gestión de Usuarios</a></li>
        <li><a href="#"><i class="fas fa-file-alt"></i> Reportes Sensibles</a></li>
        <li><a href="#"><i class="fas fa-file"></i> Páginas</a></li>
        <li><a href="#"><i class="fas fa-building"></i> Sedes</a></li>
        <li><a href="#"><i class="fas fa-exclamation-triangle"></i> Tipos de Incidentes</a></li>
        <li><a href="#"><i class="fas fa-comment-dots"></i> Feedback</a></li>
      </ul>
    </section> <!-- Closing tag for navigation-tabs section -->

    <section class="user-management-section">
      <div class="section-header">
        <i class="fas fa-users-cog"></i>
        <h2>Gestión de Usuarios</h2>
      </div>
      <p class="section-description">
        - Panel exclusivo del SuperAdmin para administrar todos los usuarios del sistema UTP+Report.
      </p>

      <div class="user-stats">
        <h2>Gestión de Usuarios del Sistema</h2>
        <div class="stats-cards">
          <div class="stat-card">
            <i class="fas fa-user-graduate"></i>
            <span>1</span>
            <p>Estudiantes</p>
          </div>
          <div class="stat-card">
            <i class="fas fa-chalkboard-teacher"></i>
            <span>0</span>
            <p>Docentes</p>
          </div>
          <div class="stat-card">
            <i class="fas fa-user-shield"></i>
            <span>1</span>
            <p>Administradores</p>
          </div>
          <div class="stat-card">
            <i class="fas fa-user-tie"></i>
            <span>1</span>
            <p>Personal Seguridad</p>
          </div>
          <div class="stat-card active-users">
            <i class="fas fa-users"></i>
            <span>4</span>
            <p>Usuarios Activos</p>
          </div>
        </div>
      </div>

      <div class="user-filters">
        <input type="text" placeholder="Buscar usuarios...">
        <select>
          <option>Todos los roles</option>
        </select>
        <select>
          <option>Todos los estados</option>
        </select>
        <button class="clear-filters-btn">Limpiar Filtros</button>
        <button class="create-user-btn" (click)="isCreating = true"><i class="fas fa-user-plus"></i> Crear Usuario</button>
      </div>

      <!-- FORMULARIO DE CREACIÓN/EDICIÓN DE USUARIOS -->
      <div *ngIf="isCreating || editingUser" class="card border-primary bg-red-50 mb-6">
        <div class="card-header">
          <h2 class="card-title">
            {{ editingUser ? 'Editar Usuario' : 'Crear Nuevo Usuario' }}
          </h2>
        </div>
        <div class="card-content space-y-4">

          <!-- CAMPOS PRINCIPALES EN GRID 3 COLUMNAS -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

            <!-- 1. NOMBRE COMPLETO -->
            <div>
              <label class="block text-sm font-medium mb-1">Nombre Completo</label>
              <input
                type="text"
                placeholder="Ej: Juan Pérez"
                [(ngModel)]="formData.name"
                class="input-field"
              />
            </div>

            <div>
              <label class="block text-sm font-medium mb-1">Username</label>
              <input
                type="text"
                placeholder="Ej: U2234567"
                [(ngModel)]="formData.username"
                class="input-field"
              />
            </div>




            <!-- 2. EMAIL CON VALIDACIÓN AUTOMÁTICA POR ROL -->
            <div>
              <label class="block text-sm font-medium mb-1">Email</label>
              <input
                type="email"
                [placeholder]="
                  formData.role === 'user' ? (
                    formData.userType === 'alumno' ? 'U1234567@utp.edu.pe' : 'C54321@utp.edu.pe'
                  ) :
                  formData.role === 'admin' ? 'D1234567@utp.edu.pe' :
                  formData.role === 'seguridad' ? 'S001@utp.edu.pe' :
                  'usuario@utp.edu.pe'
                "
                [(ngModel)]="formData.correo"
                class="input-field"
              />

              <!-- HINTS DINÁMICOS SEGÚN ROL -->
              <p *ngIf="formData.role === 'usuario' && formData.userType === 'alumno'" class="text-xs text-gray-500 mt-1">
                Para estudiantes: usar código UTP (Ej: U1234567@utp.edu.pe)
              </p>
              <p *ngIf="formData.role === 'usuario' && formData.userType === 'docente'" class="text-xs text-gray-500 mt-1">
                Para docentes: usar código UTP (Ej: C54321@utp.edu.pe)
              </p>
              <p *ngIf="formData.role === 'admin'" class="text-xs text-gray-500 mt-1">
                Para administradores: usar código personal (Ej: D1234567@utp.edu.pe)
              </p>
              <p *ngIf="formData.role === 'seguridad'" class="text-xs text-gray-500 mt-1">
                Para seguridad: usar código de empleado (Ej: S001@utp.edu.pe)
              </p>
            </div>

            <!-- 3. CONTRASEÑA -->
            <div>
              <label class="block text-sm font-medium mb-1">Contraseña</label>
              <input
                type="password"
                placeholder="Mínimo 6 caracteres"
                [(ngModel)]="formData.password"
                class="input-field"
              />
              <p class="text-xs text-gray-500 mt-1">
                {{ editingUser ? 'Dejar en blanco para mantener contraseña actual' : 'Contraseña para acceder al sistema' }}
              </p>
            </div>

            <!-- 4. TELÉFONO -->
            <div>
              <label class="block text-sm font-medium mb-1">Teléfono</label>
              <input
                type="text"
                placeholder="+51 999-000-000"
                [(ngModel)]="formData.phone"
                class="input-field"
              />
            </div>

            <!-- 5. ROL CON ICONOS -->
            <div>
              <label class="block text-sm font-medium mb-1">Rol</label>
              <select [(ngModel)]="formData.role" (change)="onRoleChange($event)" class="select-field">
                <option *ngFor="let roleKey of (roleConfig | keyvalue)" [value]="roleKey.key">
                  <i [class]="roleKey.value.icon"></i> {{ roleKey.value.label }}
                </option>
              </select>
            </div>

            <!-- 6. SEDE -->
            <div>
              <label class="block text-sm font-medium mb-1">Sede</label>
              <select [(ngModel)]="formData.campus" class="select-field">
                <option *ngIf="availableSedes.length === 0" value="" disabled>
                  No hay sedes disponibles
                </option>
                <option *ngFor="let sede of sedes" [value]="sede.id">
                  <i class="fas fa-building"></i> {{ sede.nombre }}
                </option>
              </select>
            </div>
          </div>

          <!-- SECCIÓN ESPECIAL: TIPO DE USUARIO (Solo para rol 'user') -->
          <div *ngIf="formData.role === 'usuario'" class="bg-blue-50 border-2 border-blue-200 p-4 rounded-lg">
            <label class="block text-sm font-medium mb-2 text-blue-800 flex items-center gap-2">
              <i class="fas fa-user h-4 w-4"></i>
              👥 Tipo de Usuario (OBLIGATORIO)
            </label>
            <select [(ngModel)]="formData.userType" class="select-field border-blue-300">
              <option value="alumno">
                <i class="fas fa-graduation-cap h-4 w-4 text-blue-600"></i>
                <span>👨‍🎓 alumno</span>
                <span class="badge ml-2 bg-blue-100 text-blue-700">U1234567</span>
              </option>
              <option value="docente">
                <i class="fas fa-book-open h-4 w-4 text-purple-600"></i>
                <span>👨‍🏫 Docente</span>
                <span class="badge ml-2 bg-purple-100 text-purple-700">C54321</span>
              </option>
            </select>
            <p class="text-xs text-blue-600 mt-2">
              ℹ️ Selecciona si es estudiante o docente para determinar el formato del código UTP
            </p>
          </div>

          <!-- SECCIÓN ESPECIAL: ZONAS ASIGNADAS (Solo para rol 'security') -->
          <div *ngIf="formData.role === 'seguridad'" class="border-t-2 border-primary pt-6 mt-4 bg-green-50 p-4 rounded-lg">
            <label class="block text-lg font-medium mb-4 flex items-center gap-2 text-green-800">
              <i class="fas fa-map-marker-alt h-5 w-5 text-green-600"></i>
              🗺️ Zonas Designadas para Patrullaje (OBLIGATORIO)
            </label>

            <div class="space-y-3">
              <!-- ALERTA CUANDO NO HAY ZONAS -->
              <div *ngIf="formData.assignedZones.length === 0" class="bg-red-50 border-2 border-red-200 p-4 rounded-lg">
                <div class="flex items-center gap-2 text-red-800 mb-2">
                  <i class="fas fa-map-marker-alt h-5 w-5"></i>
                  <span class="font-medium">🚨 SIN ZONAS ASIGNADAS</span>
                </div>
                <p class="text-sm text-red-700">
                  Debes asignar al menos una zona antes de poder crear este usuario de seguridad.
                </p>
              </div>

             <!-- ZONAS ACTUALMENTE ASIGNADAS -->
<div *ngIf="formData.assignedZones.length > 0" class="bg-green-50 border-2 border-green-200 p-3 rounded-lg">
  <p class="text-sm font-medium text-green-800 mb-2 flex items-center gap-2">
    <i class="fas fa-map-marker-alt h-4 w-4"></i>
    ✅ Zonas asignadas ({{ formData.assignedZones.length }}):
  </p>
  <div class="flex flex-wrap gap-2">
    <span *ngFor="let zone of formData.assignedZones" 
      class="badge pr-1 bg-white border-green-300 font-bold text-black">
  {{ zone }}
  <button
    type="button"
    (click)="handleRemoveZone(zone)"
    class="ml-2 h-4 w-4 p-0 hover:bg-red-100 remove-zone-btn"
  >
    <i class="fas fa-times h-3 w-3"></i>
  </button>
</span>

  </div>
</div>

              <!-- SELECTOR PARA AGREGAR ZONAS -->
              <div>
                <p class="text-sm font-medium text-green-800 mb-2 flex items-center gap-2">
                  <i class="fas fa-map-marker-alt h-4 w-4"></i>
                  Agregar zona de la sede:
                </p>
                <select (change)="onAddZoneChange($event)" [ngModel]="null" class="select-field"
                  [class.border-red-300]="formData.assignedZones.length === 0"
                  [class.bg-red-50]="formData.assignedZones.length === 0"
                  [class.border-green-300]="formData.assignedZones.length > 0">
                  <option value="" disabled selected>
                    {{ formData.assignedZones.length === 0 ? "🚨 SELECCIONAR ZONA OBLIGATORIA" : "Seleccionar zona adicional" }}
                  </option>
                  <option *ngFor="let zone of filteredAvailableZones" [value]="zone">
                    <i class="fas fa-map-marker-alt h-4 w-4 text-green-600"></i>
                    {{ zone }}
                  </option>
                </select>
              </div>
            </div>
          </div>

          <!-- BOTONES DE ACCIÓN -->
          <div class="flex justify-end gap-3 pt-4 border-t">
            <button type="button" class="btn btn-outline" (click)="resetForm()">
              Cancelar
            </button>
            <button
              type="button"
              (click)="editingUser ? handleUpdateUser() : handleCreateUser()"
              class="btn bg-primary hover:bg-primary/90"
            >
              {{ editingUser ? 'Actualizar Usuario' : 'Crear Usuario' }}
            </button>
          </div>
        </div>
      </div>

      <div class="user-list">
        <h3>Lista de Usuarios (3)</h3>
        <div class="user-item">
          <div class="user-info">
            <i class="fas fa-user-circle user-icon admin"></i>
            <div>
              <p class="user-name">Admin García</p>
              <p class="user-email">D1234567@utp.edu.pe</p>
              <div class="user-tags">
                <span class="tag admin-tag">Administrador</span>
                <span class="tag active-tag">Activo</span>
                <span class="tag location-tag"><i class="fas fa-map-marker-alt"></i> UTP Campus Principal</span>
              </div>
            </div>
          </div>
          <div class="user-actions">
            <button><i class="fas fa-edit"></i> Editar</button>
            <button><i class="fas fa-ban"></i> Desactivar</button>
            <button><i class="fas fa-trash-alt"></i> Eliminar</button>
          </div>
        </div>
        <div class="user-item">
          <div class="user-info">
            <i class="fas fa-user-circle user-icon security"></i>
            <div>
              <p class="user-name">Oficial Seguridad</p>
              <p class="user-email">S001@utp.edu.pe</p>
              <div class="user-tags">
                <span class="tag security-tag">Seguridad</span>
                <span class="tag active-tag">Activo</span>
                <span class="tag location-tag"><i class="fas fa-map-marker-alt"></i> UTP Campus Principal</span>
              </div>
            </div>
          </div>
          <div class="user-actions">
            <button><i class="fas fa-edit"></i> Editar</button>
            <button><i class="fas fa-ban"></i> Desactivar</button>
            <button><i class="fas fa-trash-alt"></i> Eliminar</button>
          </div>
        </div>
        <div class="user-item">
          <div class="user-info">
            <i class="fas fa-user-circle user-icon user"></i>
            <div>
              <p class="user-name">Juan Pérez</p>
              <p class="user-email">U1234567@utp.edu.pe</p>
              <div class="user-tags">
                <span class="tag user-tag">Usuario</span>
                <span class="tag active-tag">Activo</span>
                <span class="tag location-tag"><i class="fas fa-map-marker-alt"></i> UTP Campus Principal</span>
              </div>
            </div>
          </div>
          <div class="user-actions">
            <button><i class="fas fa-edit"></i> Editar</button>
            <button><i class="fas fa-ban"></i> Desactivar</button>
            <button><i class="fas fa-trash-alt"></i> Eliminar</button>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
